# pull from our emane and opentestpoint builds
FROM gcr.io/automated-builds-303920/ubuntu20.04.emane
FROM gcr.io/automated-builds-303920/ubuntu20.04.opentestpoint

# prevent failures due to interactive apt transactions
ENV DEBIAN_FRONTEND=noninteractive
RUN apt-get -y update
RUN apt-get -y upgrade --no-install-recommends

# Build Depends
RUN apt-get -y install python3-lxml

WORKDIR /opt
RUN git clone https://github.com/adjacentlink/opentestpoint-probe-emane -b develop

WORKDIR opentestpoint-probe-emane
RUN ./autogen.sh
RUN ./configure
RUN make deb
RUN dpkg -i $(find .debbuild -name "*\.deb"); apt-get -y -f install

RUN echo 'complete'

